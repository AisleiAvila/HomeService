<div class="bg-white rounded-lg shadow overflow-hidden">
  <ul class="divide-y divide-gray-200">
    @if (serviceRequests().length === 0) {
    <li class="p-6 text-center text-gray-500">
      {{ "noServiceRequestsFound" | i18n }}
    </li>
    } @else { @for (request of serviceRequests(); track request.id) {
    <li class="p-3 sm:p-4 hover:bg-gray-50 transition-colors">
      <div class="flex flex-col space-y-3">
        <div class="flex-1 min-w-0">
          <p class="text-sm font-semibold text-blue-600">
            {{ request.category }}
          </p>
          <h4 class="text-base sm:text-lg font-bold text-gray-800 break-words">
            {{ request.title }}
          </h4>
          <p class="text-xs sm:text-sm text-gray-500 mt-1 break-words">
            {{ formatAddress(request) }}
          </p>
          @if(request.status === 'Quoted' && request.cost) {
          <p class="text-sm font-medium text-green-600">
            {{ "quote" | i18n }}: â‚¬{{ request.cost | number : "1.2-2" }}
          </p>
          }
        </div>
        <div
          class="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0"
        >
          <span [class]="statusClass(request.status)" class="inline-block">
            {{ request.status }}
            @if(request.payment_status === 'Paid') {
            <span class="ml-2 font-bold text-green-700"
              >({{ "paid" | i18n }})</span
            >
            }
          </span>
          <div class="flex flex-wrap gap-2 w-full sm:w-auto">
            <!-- Client Actions -->
            @if(currentUser().role === 'client') { @if(request.status ===
            'Quoted') {
            <button
              (click)="approveQuote.emit(request)"
              class="px-2 py-1 text-xs sm:text-sm font-medium text-white bg-green-500 rounded-md hover:bg-green-600 flex-1 sm:flex-none min-w-0"
            >
              {{ "approve" | i18n }}
            </button>
            <button
              (click)="rejectQuote.emit(request)"
              class="px-2 py-1 text-xs sm:text-sm font-medium text-white bg-red-500 rounded-md hover:bg-red-600 flex-1 sm:flex-none min-w-0"
            >
              {{ "reject" | i18n }}
            </button>
            } @if(request.status === 'Approved') {
            <button
              (click)="scheduleRequest.emit(request)"
              class="px-2 py-1 text-xs sm:text-sm font-medium text-white bg-teal-500 rounded-md hover:bg-teal-600 flex-1 sm:flex-none min-w-0"
            >
              {{ "schedule" | i18n }}
            </button>
            } @if(request.status === 'Completed' && request.payment_status ===
            'Unpaid') {
            <button
              (click)="payNow.emit(request)"
              class="px-2 py-1 text-xs sm:text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 flex-1 sm:flex-none min-w-0"
            >
              {{ "payNow" | i18n }}
            </button>
            } }
            <button
              (click)="viewDetails.emit(request)"
              class="px-2 py-1 text-xs sm:text-sm font-medium text-white bg-blue-500 rounded-md hover:bg-blue-600 flex-1 sm:flex-none min-w-0"
            >
              {{ "details" | i18n }}
            </button>
            <button
              (click)="openChat.emit(request)"
              class="px-2 py-1 text-xs sm:text-sm font-medium text-white bg-gray-700 rounded-md hover:bg-gray-800 flex-1 sm:flex-none min-w-0"
            >
              {{ "chat" | i18n }}
            </button>
          </div>
        </div>
      </div>
    </li>
    } }
  </ul>
</div>
