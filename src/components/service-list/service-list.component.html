<div class="bg-white rounded-lg shadow overflow-hidden">
  <ul class="divide-y divide-gray-200">
    @if (serviceRequests().length === 0) {
      <li class="p-6 text-center text-gray-500">{{ 'noServiceRequestsFound' | i18n }}</li>
    } @else {
      @for (request of serviceRequests(); track request.id) {
        <li class="p-4 hover:bg-gray-50 transition-colors">
          <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between">
            <div class="flex-1 min-w-0">
              <p class="text-sm font-semibold text-blue-600">{{ request.category }}</p>
              <h4 class="text-lg font-bold text-gray-800 truncate">{{ request.title }}</h4>
              <p class="text-sm text-gray-500 mt-1">{{ formatAddress(request.address) }}</p>
              @if(request.status === 'Quoted' && request.cost) {
                <p class="text-sm font-medium text-green-600">{{ 'quote' | i18n }}: {{ request.cost | currency:currencyCode() }}</p>
              }
            </div>
            <div class="mt-4 sm:mt-0 sm:ml-4 flex-shrink-0 flex flex-col items-start sm:items-end space-y-2">
              <span [class]="statusClass(request.status)">
                {{ request.status }}
                @if(request.paymentStatus === 'Paid') {
                  <span class="ml-2 font-bold text-green-700">({{ 'paid' | i18n }})</span>
                }
              </span>
              <div class="flex space-x-2 mt-2">
                <!-- Client Actions -->
                @if(currentUser().role === 'client') {
                   @if(request.status === 'Quoted') {
                     <button (click)="approveQuote.emit(request)" class="px-3 py-1 text-sm font-medium text-white bg-green-500 rounded-md hover:bg-green-600">{{ 'approve' | i18n }}</button>
                     <button (click)="rejectQuote.emit(request)" class="px-3 py-1 text-sm font-medium text-white bg-red-500 rounded-md hover:bg-red-600">{{ 'reject' | i18n }}</button>
                   }
                   @if(request.status === 'Completed' && request.paymentStatus === 'Unpaid') {
                     <button (click)="payNow.emit(request)" class="px-3 py-1 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700">{{ 'payNow' | i18n }}</button>
                   }
                }
                 <button (click)="viewDetails.emit(request)" class="px-3 py-1 text-sm font-medium text-white bg-blue-500 rounded-md hover:bg-blue-600">{{ 'details' | i18n }}</button>
                 <button (click)="openChat.emit(request)" class="px-3 py-1 text-sm font-medium text-white bg-gray-700 rounded-md hover:bg-gray-800">{{ 'chat' | i18n }}</button>
              </div>
            </div>
          </div>
        </li>
      }
    }
  </ul>
</div>