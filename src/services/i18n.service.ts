import { Injectable, signal } from '@angular/core';

export type Language = 'pt' | 'en';

const translations: Record<Language, Record<string, string>> = {
  pt: {
    // Geral
    'signIn': 'Entrar',
    'createAccount': 'Criar Conta',
    'cancel': 'Cancelar',
    'submit': 'Enviar',
    'or': 'Ou',
    'logout': 'Sair',
    'details': 'Detalhes',
    'description': 'Descrição',
    'address': 'Endereço',
    'category': 'Categoria',
    'status': 'Status',
    'cost': 'Custo',
    'payment': 'Pagamento',
    'action': 'Ação',
    'actions': 'Ações',
    'edit': 'Editar',
    'add': 'Adicionar',
    'name': 'Nome',
    'email': 'E-mail',
    'phone': 'Telefone',
    'password': 'Senha',
    'client': 'Cliente',
    'professional': 'Profissional',
    'unassigned': 'Não atribuído',
    'unknownClient': 'Cliente Desconhecido',
    'paid': 'Pago',
    'unpaid': 'Pendente',
    'currency': 'BRL',
    
    // Auth Flow
    'landingDescription': 'A sua solução completa para serviços de manutenção e reparação residencial. Conecte-se com especialistas de confiança para tudo o que precisar.',
    'loginTitle': 'Faça login em sua conta',
    'loginCreateAccountLink': 'crie uma nova conta',
    'emailPlaceholder': 'Endereço de e-mail',
    'passwordPlaceholder': 'Senha',
    'registerTitle': 'Criar uma nova conta',
    'registerLoginLink': 'faça login na sua conta existente',
    'fullName': 'Nome completo',
    'emailAddress': 'Endereço de e-mail',
    'iAmA': 'Eu sou um',
    'register': 'Registrar',
    'accountVerification': 'Verificação de conta',
    'verificationCodeSentTo': 'Enviamos um código de verificação para',
    'verificationCode': 'Código de verificação',
    'verify': 'Verificar',
    'resendCode': 'Reenviar código',

    // Notificações e Erros
    'accountPending': 'Sua conta está com aprovação pendente.',
    'accountRejected': 'Sua conta foi rejeitada.',
    'welcomeBack': 'Bem-vindo(a) de volta, {name}!',
    'invalidCredentials': 'Credenciais inválidas.',
    'registrationSuccess': 'Cadastro realizado com sucesso! Verifique seu e-mail para ativar sua conta.',
    'accountVerified': 'Conta verificada! Por favor, faça o login.',
    'verificationCodeResent': 'Código de verificação reenviado para {email}.',
    'paymentProcessStarted': 'Processo de pagamento iniciado para "{title}".',
    'requestSubmittedNotification': 'Nova solicitação "{title}" enviada.',
    'clientAccountApproved': 'Conta de cliente aprovada.',
    'clientAccountRejected': 'Conta de cliente rejeitada.',
    'quoteSubmittedNotification': 'Cotação de {amount} enviada para a solicitação #{id}.',
    'approvedStatus': 'aprovada',
    'rejectedStatus': 'rejeitada',
    'quoteResponseNotification': 'A cotação para a solicitação #{id} foi {status}.',
    'professionalAssignedNotification': 'Profissional atribuído à solicitação #{id}.',
    'profileUpdatedNotification': 'Perfil para usuário #{id} atualizado.',
    'categoryAddedNotification': 'Categoria "{category}" adicionada.',
    'categoryUpdatedNotification': 'Categoria "{oldName}" atualizada para "{newName}".',
    'categoryDeletedNotification': 'Categoria "{category}" deletada.',
    'professionalAddedNotification': 'Profissional "{name}" adicionado.',
    'noChangesDetected': 'Nenhuma alteração detectada.',
    'errorInvalidFileFormat': 'Erro: Formato de arquivo inválido. Use JPG, PNG ou GIF.',
    'errorImageTooLarge': 'Erro: A imagem é muito grande. O tamanho máximo é 2MB.',
    'errorCameraNotSupported': 'Erro: A câmera não é suportada neste navegador.',
    'errorAccessingCamera': 'Erro: Não foi possível acessar a câmera. Verifique as permissões.',

    // Main App
    'dashboard': 'Dashboard',
    'schedule': 'Agenda',
    'search': 'Busca',
    'profile': 'Perfil',
    'newRequest': 'Nova Solicitação',
    'adminPanel': 'Painel do Administrador',
    'detailsFor': 'Detalhes para: {title}',
    'chatFor': 'Chat para: {title}',
    'request': 'Solicitação',
    'requested': 'Solicitado',
    'scheduled': 'Agendado',
    'notSet': 'Não definido',
    'financials': 'Financeiro',
    'notQuoted': 'Sem cotação',
    'backToDashboard': 'Voltar para o Dashboard',
    'serviceRequestNotFound': 'Pedido de serviço não encontrado.',
    'dashboardSummary': 'Aqui está um resumo de suas solicitações de serviço.',
    'pendingApproval': 'Aprovação Pendente',
    'activeRequests': 'Solicitações Ativas',
    'completed': 'Concluído',
    'activeJobs': 'Trabalhos Ativos',
    'completedJobs': 'Trabalhos Concluídos',
    'totalEarnings': 'Ganhos Totais',
    'completedRequests': 'Solicitações Concluídas',
    'noServiceRequestsFound': 'Nenhuma solicitação de serviço encontrada.',
    'quote': 'Cotação',
    'approve': 'Aprovar',
    'reject': 'Rejeitar',
    'payNow': 'Pagar Agora',
    'chat': 'Chat',
    'chatDiscussing': 'Discutindo',
    'noProfessionalAssigned': 'Nenhum profissional atribuído',
    'chatPlaceholder': 'Digite sua mensagem...',
    'chatSimulatedReply': 'Obrigado pela mensagem, retornarei em breve.',
    
    // Service Request Form
    'createNewServiceRequest': 'Criar Nova Solicitação de Serviço',
    'serviceTitle': 'Título do Serviço',
    'serviceTitlePlaceholder': 'Ex: Consertar vazamento na pia da cozinha',
    'descriptionPlaceholder': 'Forneça o máximo de detalhes possível sobre o problema.',
    'serviceAddress': 'Endereço do Serviço',
    'street': 'Rua',
    'city': 'Cidade',
    'state': 'Estado',
    'zipCode': 'CEP',
    'preferredDate': 'Data de Preferência',
    'submitRequest': 'Enviar Solicitação',
    
    // Profile
    'uploadPhoto': 'Carregar foto',
    'useCamera': 'Usar câmera',
    'mySpecialties': 'Minhas Especialidades',
    'saveChanges': 'Salvar Alterações',
    'capturePhoto': 'Capturar Foto',
    'capture': 'Capturar',

    // Search
    'searchServiceRequests': 'Buscar Solicitações de Serviço',
    'searchTerm': 'Termo de Busca',
    'searchTermPlaceholder': 'Ex: vazamento, pintura',
    'allCategories': 'Todas as Categorias',
    'allStatuses': 'Todos os Status',
    'results': 'Resultados',
    'noResultsFound': 'Nenhum resultado encontrado para seus critérios de busca.',

    // Notifications
    'notifications': 'Notificações',
    'noNewNotifications': 'Nenhuma notificação nova.',
    'markAllAsRead': 'Marcar todas como lidas',
    'clearAll': 'Limpar todas',

    // Admin Dashboard
    'overview': 'Visão Geral',
    'requests': 'Solicitações',
    'approvals': 'Aprovações',
    'finances': 'Finanças',
    'professionals': 'Profissionais',
    'categories': 'Categorias',
    'totalRevenue': 'Receita Total',
    'pendingApprovals': 'Aprovações Pendentes',
    'activeServices': 'Serviços Ativos',
    'totalProfessionals': 'Total de Profissionais',
    'pendingActions': 'Ações Pendentes',
    'noRequestsNeedAttention': 'Nenhuma solicitação precisa de atenção.',
    'viewQuote': 'Ver Cotação',
    'provideQuote': 'Fornecer Cotação',
    'assign': 'Atribuir',
    'pendingRegistrations': 'Cadastros Pendentes',
    'noPendingRegistrations': 'Nenhum cadastro pendente.',
    'confirmRejectRegistration': 'Tem certeza de que deseja rejeitar este cadastro?',
    'completedServices': 'Serviços Concluídos',
    'totalTax': 'Total de Impostos',
    'outstandingAmount': 'Valor Pendente',
    'financialDetails': 'Detalhes Financeiros',
    'exportToCsv': 'Exportar para CSV',
    'noDataToExport': 'Não há dados para exportar.',
    'reportExported': 'Relatório exportado.',
    'csvId': 'ID',
    'csvClient': 'Cliente',
    'csvProfessional': 'Profissional',
    'csvService': 'Serviço',
    'csvCompletionDate': 'Data Conclusão',
    'csvPaymentStatus': 'Status Pag.',
    'csvBaseValue': 'Valor Base',
    'csvTax': 'Imposto',
    'csvTotalValue': 'Valor Total',
    'generateInvoice': 'Gerar Fatura',
    'manageProfessionals': 'Gerenciar Profissionais',
    'addProfessional': 'Adicionar Profissional',
    'specialties': 'Especialidades',
    'addNewCategory': 'Adicionar Nova Categoria',
    'categoryName': 'Nome da Categoria',
    'serviceCategories': 'Categorias de Serviço',
    'confirmDeleteCategory': 'Tem certeza de que deseja excluir a categoria "{category}"?',
    'quoteFor': 'Cotação para',
    'quoteValue': 'Valor da Cotação',
    'assignProfessional': 'Atribuir Profissional',
    'selectProfessionalFor': 'Selecione um profissional para',
    'selectAProfessional': 'Selecione um profissional',
    'editProfessional': 'Editar Profissional',
    'addNewProfessional': 'Adicionar Novo Profissional',
    'invoice': 'Fatura',
    'billedTo': 'Faturado Para',
    'serviceProvidedBy': 'Serviço Realizado Por',
    'serviceDescription': 'Descrição do Serviço',
    'total': 'Total',
    'subtotal': 'Subtotal',
    'tax': 'Imposto',
    'grandTotal': 'Total Geral',
    'thankYou': 'Obrigado por escolher nossos serviços!',
    'close': 'Fechar',
    'print': 'Imprimir',
  },
  en: {
    // General
    'signIn': 'Sign In',
    'createAccount': 'Create Account',
    'cancel': 'Cancel',
    'submit': 'Submit',
    'or': 'Or',
    'logout': 'Logout',
    'details': 'Details',
    'description': 'Description',
    'address': 'Address',
    'category': 'Category',
    'status': 'Status',
    'cost': 'Cost',
    'payment': 'Payment',
    'action': 'Action',
    'actions': 'Actions',
    'edit': 'Edit',
    'add': 'Add',
    'name': 'Name',
    'email': 'Email',
    'phone': 'Phone',
    'password': 'Password',
    'client': 'Client',
    'professional': 'Professional',
    'unassigned': 'Unassigned',
    'unknownClient': 'Unknown Client',
    'paid': 'Paid',
    'unpaid': 'Unpaid',
    'currency': 'USD',

    // Auth Flow
    'landingDescription': 'Your complete solution for home maintenance and repair services. Connect with trusted experts for everything you need.',
    'loginTitle': 'Sign in to your account',
    'loginCreateAccountLink': 'create a new account',
    'emailPlaceholder': 'Email address',
    'passwordPlaceholder': 'Password',
    'registerTitle': 'Create a new account',
    'registerLoginLink': 'sign in to your existing account',
    'fullName': 'Full name',
    'emailAddress': 'Email address',
    'iAmA': 'I am a:',
    'register': 'Register',
    'accountVerification': 'Account Verification',
    'verificationCodeSentTo': 'We have sent a verification code to',
    'verificationCode': 'Verification code',
    'verify': 'Verify',
    'resendCode': 'Resend code',

    // Notifications & Errors
    'accountPending': 'Your account is pending approval.',
    'accountRejected': 'Your account has been rejected.',
    'welcomeBack': 'Welcome back, {name}!',
    'invalidCredentials': 'Invalid credentials.',
    'registrationSuccess': 'Registration successful! Please check your email to verify your account.',
    'accountVerified': 'Account verified! Please log in.',
    'verificationCodeResent': 'Verification code resent to {email}.',
    'paymentProcessStarted': 'Payment process started for "{title}".',
    'requestSubmittedNotification': 'New request "{title}" submitted.',
    'clientAccountApproved': 'Client account approved.',
    'clientAccountRejected': 'Client account rejected.',
    'quoteSubmittedNotification': 'Quote of {amount} submitted for request #{id}.',
    'approvedStatus': 'approved',
    'rejectedStatus': 'rejected',
    'quoteResponseNotification': 'Quote for request #{id} has been {status}.',
    'professionalAssignedNotification': 'Professional assigned to request #{id}.',
    'profileUpdatedNotification': 'Profile for user #{id} updated.',
    'categoryAddedNotification': 'Category "{category}" added.',
    'categoryUpdatedNotification': 'Category "{oldName}" updated to "{newName}".',
    'categoryDeletedNotification': 'Category "{category}" deleted.',
    'professionalAddedNotification': 'Professional "{name}" added.',
    'noChangesDetected': 'No changes detected.',
    'errorInvalidFileFormat': 'Error: Invalid file format. Use JPG, PNG, or GIF.',
    'errorImageTooLarge': 'Error: Image is too large. Maximum size is 2MB.',
    'errorCameraNotSupported': 'Error: Camera is not supported in this browser.',
    'errorAccessingCamera': 'Error: Could not access camera. Check permissions.',

    // Main App
    'dashboard': 'Dashboard',
    'schedule': 'Schedule',
    'search': 'Search',
    'profile': 'Profile',
    'newRequest': 'New Request',
    'adminPanel': 'Admin Panel',
    'detailsFor': 'Details for: {title}',
    'chatFor': 'Chat for: {title}',
    'request': 'Request',
    'requested': 'Requested',
    'scheduled': 'Scheduled',
    'notSet': 'Not set',
    'financials': 'Financials',
    'notQuoted': 'Not quoted',
    'backToDashboard': 'Back to Dashboard',
    'serviceRequestNotFound': 'Service request not found.',
    'dashboardSummary': 'Here\'s a summary of your service requests.',
    'pendingApproval': 'Pending Approval',
    'activeRequests': 'Active Requests',
    'completed': 'Completed',
    'activeJobs': 'Active Jobs',
    'completedJobs': 'Completed Jobs',
    'totalEarnings': 'Total Earnings',
    'completedRequests': 'Completed Requests',
    'noServiceRequestsFound': 'No service requests found.',
    'quote': 'Quote',
    'approve': 'Approve',
    'reject': 'Reject',
    'payNow': 'Pay Now',
    'chat': 'Chat',
    'chatDiscussing': 'Discussing',
    'noProfessionalAssigned': 'No Professional Assigned',
    'chatPlaceholder': 'Type your message...',
    'chatSimulatedReply': 'Thanks for the message, I will get back to you shortly.',

    // Service Request Form
    'createNewServiceRequest': 'Create a New Service Request',
    'serviceTitle': 'Service Title',
    'serviceTitlePlaceholder': 'e.g., Fix leaky pipe under kitchen sink',
    'descriptionPlaceholder': 'Provide as much detail as possible about the issue.',
    'serviceAddress': 'Service Address',
    'street': 'Street',
    'city': 'City',
    'state': 'State',
    'zipCode': 'ZIP Code',
    'preferredDate': 'Preferred Date',
    'submitRequest': 'Submit Request',
    
    // Profile
    'uploadPhoto': 'Upload photo',
    'useCamera': 'Use camera',
    'mySpecialties': 'My Specialties',
    'saveChanges': 'Save Changes',
    'capturePhoto': 'Capture Photo',
    'capture': 'Capture',

    // Search
    'searchServiceRequests': 'Search Service Requests',
    'searchTerm': 'Search Term',
    'searchTermPlaceholder': 'e.g., leaky faucet, painting',
    'allCategories': 'All Categories',
    'allStatuses': 'All Statuses',
    'results': 'Results',
    'noResultsFound': 'No results found for your search criteria.',

    // Notifications
    'notifications': 'Notifications',
    'noNewNotifications': 'No new notifications.',
    'markAllAsRead': 'Mark all as read',
    'clearAll': 'Clear All',

    // Admin Dashboard
    'overview': 'Overview',
    'requests': 'Requests',
    'approvals': 'Approvals',
    'finances': 'Finances',
    'professionals': 'Professionals',
    'categories': 'Categories',
    'totalRevenue': 'Total Revenue',
    'pendingApprovals': 'Pending Approvals',
    'activeServices': 'Active Services',
    'totalProfessionals': 'Total Professionals',
    'pendingActions': 'Pending Actions',
    'noRequestsNeedAttention': 'No requests need attention.',
    'viewQuote': 'View Quote',
    'provideQuote': 'Provide Quote',
    'assign': 'Assign',
    'pendingRegistrations': 'Pending Registrations',
    'noPendingRegistrations': 'No pending registrations.',
    'confirmRejectRegistration': 'Are you sure you want to reject this registration?',
    'completedServices': 'Completed Services',
    'totalTax': 'Total Tax',
    'outstandingAmount': 'Outstanding Amount',
    'financialDetails': 'Financial Details',
    'exportToCsv': 'Export to CSV',
    'noDataToExport': 'No data to export.',
    'reportExported': 'Report exported.',
    'csvId': 'ID',
    'csvClient': 'Client',
    'csvProfessional': 'Professional',
    'csvService': 'Service',
    'csvCompletionDate': 'Completion Date',
    'csvPaymentStatus': 'Payment Status',
    'csvBaseValue': 'Base Value',
    'csvTax': 'Tax',
    'csvTotalValue': 'Total Value',
    'generateInvoice': 'Generate Invoice',
    'manageProfessionals': 'Manage Professionals',
    'addProfessional': 'Add Professional',
    'specialties': 'Specialties',
    'addNewCategory': 'Add New Category',
    'categoryName': 'Category Name',
    'serviceCategories': 'Service Categories',
    'confirmDeleteCategory': 'Are you sure you want to delete the category "{category}"?',
    'quoteFor': 'Quote for',
    'quoteValue': 'Quote Value',
    'assignProfessional': 'Assign Professional',
    'selectProfessionalFor': 'Select a professional for',
    'selectAProfessional': 'Select a professional',
    'editProfessional': 'Edit Professional',
    'addNewProfessional': 'Add New Professional',
    'invoice': 'Invoice',
    'billedTo': 'Billed To',
    'serviceProvidedBy': 'Service Provided By',
    'serviceDescription': 'Service Description',
    'total': 'Total',
    'subtotal': 'Subtotal',
    'tax': 'Tax',
    'grandTotal': 'Grand Total',
    'thankYou': 'Thank you for choosing our services!',
    'close': 'Close',
    'print': 'Print',
  },
};

@Injectable({ providedIn: 'root' })
export class I18nService {
  language = signal<Language>('pt');

  setLanguage(lang: Language) {
    this.language.set(lang);
  }

  translate(key: string, params: Record<string, string | number> = {}): string {
    const lang = this.language();
    let translation = translations[lang][key] || key;
    
    // Replace placeholders like {name}
    for (const param in params) {
      translation = translation.replace(`{${param}}`, String(params[param]));
    }
    
    return translation;
  }
}
