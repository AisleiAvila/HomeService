import { Injectable, signal } from '@angular/core';

export type Language = 'en' | 'pt';

@Injectable({
  providedIn: 'root'
})
export class I18nService {
  language = signal<Language>('pt');
  
  private translations: Record<Language, Record<string, string>> = {
    en: {
      // Auth & Landing
      landingDescription: 'Find trusted professionals for any home service you need. Fast, reliable, and just a click away.',
      signIn: 'Sign In',
      createAccount: 'Create Account',
      loginTitle: 'Sign in to your account',
      or: 'or',
      loginCreateAccountLink: 'create a new account',
      emailPlaceholder: 'Email address',
      passwordPlaceholder: 'Password',
      cancel: 'Cancel',
      registerTitle: 'Create a new account',
      registerLoginLink: 'log in to your existing account',
      fullName: 'Full Name',
      emailAddress: 'Email address',
      password: 'Password',
      iAmA: 'I am a:',
      client: 'Client',
      professional: 'Professional',
      register: 'Register',
      accountVerification: 'Account Verification',
      verificationCodeSentTo: 'A verification code has been sent to',
      verificationCode: 'Verification Code',
      verify: 'Verify',
      resendCode: 'Resend code',
      logout: 'Logout',
      
      // General UI
      notifications: 'Notifications',
      noNewNotifications: 'No new notifications',
      markAllAsRead: 'Mark all as read',
      clearAll: 'Clear All',
      enablePushNotifications: 'Enable Push Notifications',
      request: 'Request',
      description: 'Description',
      address: 'Address',
      details: 'Details',
      requested: 'Requested',
      scheduled: 'Scheduled',
      notSet: 'Not Set',
      financials: 'Financials',
      cost: 'Cost',
      notQuoted: 'Not Quoted',
      payment: 'Payment',
      backToDashboard: 'Back to Dashboard',
      serviceRequestNotFound: 'Service Request not found.',
      dashboardSummary: 'Here is a summary of your activities.',
      noServiceRequestsFound: 'No service requests found.',
      quote: 'Quote',
      approve: 'Approve',
      reject: 'Reject',
      payNow: 'Pay Now',
      chat: 'Chat',
      chatDiscussing: 'Discussing',
      noProfessionalAssigned: 'No professional assigned yet.',
      chatPlaceholder: 'Type your message...',
      uploadPhoto: 'Upload photo',
      useCamera: 'Use camera',
      mySpecialties: 'My Specialties',
      saveChanges: 'Save Changes',
      capturePhoto: 'Capture Photo',
      capture: 'Capture',
      
      // Search
      searchServiceRequests: 'Search Service Requests',
      searchTerm: 'Search Term',
      searchTermPlaceholder: 'e.g., "leaky faucet"',
      allCategories: 'All Categories',
      allStatuses: 'All Statuses',
      results: 'Results',
      noResultsFound: 'No results found for your criteria.',
      
      // Scheduling
      scheduleAppointmentFor: 'Schedule Appointment For',
      selectProfessional: 'Select Professional',
      selectAProfessional: 'Select a professional',
      selectACategory: 'Select a category',
      selectDate: 'Select Date',
      selectTime: 'Select Time',
      confirmSchedule: 'Confirm Schedule',
      
      // Admin
      pendingActions: 'Pending Actions',
      noRequestsNeedAttention: 'No requests need your attention right now.',
      viewQuote: 'View Quote',
      provideQuote: 'Provide Quote',
      assign: 'Assign',
      pendingRegistrations: 'Pending Registrations',
      name: 'Name',
      phone: 'Phone',
      noPendingRegistrations: 'There are no pending registrations.',
      financialDetails: 'Financial Details',
      exportToCsv: 'Export to CSV',
      date: 'Date',
      total: 'Total',
      action: 'Action',
      generateInvoice: 'Generate Invoice',
      manageProfessionals: 'Manage Professionals',
      addProfessional: 'Add Professional',
      addNewProfessional: 'Add New Professional',
      specialties: 'Specialties',
      add: 'Add',
      edit: 'Edit',
      addNewCategory: 'Add New Category',
      categoryName: 'Category Name',
      serviceCategories: 'Service Categories',
      delete: 'Delete',
      quoteFor: 'Quote For',
      quoteValue: 'Quote Value',
      submit: 'Submit',
      assignProfessional: 'Assign Professional',
      selectProfessionalFor: 'Select a professional for',
      editProfessional: 'Edit Professional',
      invoice: 'Invoice',
      billedTo: 'Billed To',
      serviceProvidedBy: 'Service Provided By',
      serviceDescription: 'Service Description',
      subtotal: 'Subtotal',
      tax: 'Tax',
      grandTotal: 'Grand Total',
      thankYou: 'Thank you for your business!',
      close: 'Close',
      print: 'Print',

      // General
      dashboard: 'Dashboard',
      schedule: 'Schedule',
      search: 'Search',
      profile: 'Profile',
      newRequest: 'New Request',
      adminPanel: 'Admin Panel',
      welcomeBack: 'Welcome back, {name}!',
      invalidCredentials: 'Invalid email or password.',
      accountPending: 'Your account is pending approval.',
      accountRejected: 'Your account has been rejected.',
      registrationSuccess: 'Registration successful! Please check your email for a verification code.',
      accountVerified: 'Account verified successfully. You can now log in.',
      verificationCodeResent: 'A new verification code has been sent to {email}.',
      detailsFor: 'Details for: {title}',
      chatFor: 'Chat for: {title}',
      paymentProcessStarted: 'Payment process started for "{title}".',
      requestSubmittedNotification: 'New request "{title}" submitted successfully.',
      clientAccountApproved: 'Client account has been approved.',
      clientAccountRejected: 'Client account has been rejected.',
      pushAccountApprovedTitle: 'Account Approved!',
      pushAccountApprovedBody: 'Welcome, {name}! Your account is now active.',
      quoteSubmittedNotification: 'Quote of {amount} submitted for request #{id}.',
      pushQuoteReceivedTitle: 'You\'ve Received a Quote!',
      pushQuoteReceivedBody: 'A new quote of {amount} has been submitted for "{title}".',
      approvedStatus: 'approved',
      rejectedStatus: 'rejected',
      quoteResponseNotification: 'Quote for request #{id} has been {status}.',
      pushQuoteResponseTitle: 'Quote Response',
      pushQuoteResponseBody: 'The quote for "{title}" has been {status}.',
      professionalAssignedNotification: 'A professional has been assigned to request #{id}.',
      pushJobAssignedTitle: 'New Job Assignment!',
      pushJobAssignedBody: 'You have been assigned to a new job: "{title}".',
      appointmentScheduledNotification: 'Appointment scheduled for "{title}".',
      pushAppointmentScheduledTitle: 'New Appointment Scheduled!',
      pushAppointmentScheduledBody: 'An appointment for "{title}" has been scheduled for {date}.',
      profileUpdatedNotification: 'Profile for user #{id} updated.',
      noChangesDetected: 'No changes to save.',
      errorInvalidFileFormat: 'Invalid file format. Please upload a JPG, PNG, or GIF.',
      errorImageTooLarge: 'Image is too large. The maximum size is 2MB.',
      errorCameraNotSupported: 'Camera access is not supported by your browser.',
      errorAccessingCamera: 'Error accessing camera. Please ensure you have granted permission.',
      categoryAddedNotification: 'Category "{category}" added.',
      categoryUpdatedNotification: 'Category "{oldName}" updated to "{newName}".',
      categoryDeletedNotification: 'Category "{category}" deleted.',
      confirmDeleteCategory: 'Are you sure you want to delete the category "{category}"? This cannot be undone.',
      professionalAddedNotification: 'Professional "{name}" has been added.',
      pushNotificationsBlocked: 'Push notifications are blocked. Please enable them in your browser settings.',
      pushSubscriptionFailed: 'Failed to subscribe to push notifications.',
      currency: 'USD',
      chatSimulatedReply: 'Okay, I will check that and get back to you.',
      unknownClient: 'Unknown Client',
      unassigned: 'Unassigned',
      confirmRejectRegistration: 'Are you sure you want to reject this registration?',
      noDataToExport: 'There is no financial data to export.',
      reportExported: 'Financial report exported successfully.',
      csvId: 'ID',
      csvClient: 'Client',
      csvProfessional: 'Professional',
      csvService: 'Service',
      csvCompletionDate: 'Completion Date',
      csvPaymentStatus: 'Payment Status',
      csvBaseValue: 'Base Value',
      csvTax: 'Tax (7%)',
      csvTotalValue: 'Total Value',
      paid: 'Paid',
      unpaid: 'Unpaid',
      overview: 'Overview',
      requests: 'Requests',
      approvals: 'Approvals',
      professionals: 'Professionals',
      categories: 'Categories',
      finances: 'Finances',
      totalRevenue: 'Total Revenue',
      pendingApprovals: 'Pending Approvals',
      activeServices: 'Active Services',
      totalProfessionals: 'Total Professionals',
      pendingApproval: 'Pending Approval',
      activeRequests: 'Active Requests',
      completed: 'Completed',
      activeJobs: 'Active Jobs',
      completedJobs: 'Completed Jobs',
      totalEarnings: 'Total Earnings',
      serviceTitle: 'Service Title',
      detailedDescription: 'Detailed Description',
      category: 'Category',
      serviceAddress: 'Service Address',
      searchForAddress: 'Search for an address...',
      preferredDate: 'Preferred Date',
      optional: 'Optional',
      reset: 'Reset',
      submitRequest: 'Submit Request',
    },
    pt: {
      // Auth & Landing
      landingDescription: 'Encontre profissionais de confiança para qualquer serviço doméstico que precisar. Rápido, confiável e a apenas um clique.',
      signIn: 'Entrar',
      createAccount: 'Criar Conta',
      loginTitle: 'Faça login em sua conta',
      or: 'ou',
      loginCreateAccountLink: 'crie uma nova conta',
      emailPlaceholder: 'Endereço de e-mail',
      passwordPlaceholder: 'Senha',
      cancel: 'Cancelar',
      registerTitle: 'Criar uma nova conta',
      registerLoginLink: 'faça login na sua conta existente',
      fullName: 'Nome Completo',
      emailAddress: 'Endereço de e-mail',
      password: 'Senha',
      iAmA: 'Eu sou um(a):',
      client: 'Cliente',
      professional: 'Profissional',
      register: 'Registrar',
      accountVerification: 'Verificação de Conta',
      verificationCodeSentTo: 'Um código de verificação foi enviado para',
      verificationCode: 'Código de Verificação',
      verify: 'Verificar',
      resendCode: 'Reenviar código',
      logout: 'Sair',

      // General UI
      notifications: 'Notificações',
      noNewNotifications: 'Nenhuma nova notificação',
      markAllAsRead: 'Marcar todas como lidas',
      clearAll: 'Limpar todas',
      enablePushNotifications: 'Ativar Notificações Push',
      request: 'Pedido',
      description: 'Descrição',
      address: 'Endereço',
      details: 'Detalhes',
      requested: 'Solicitado',
      scheduled: 'Agendado',
      notSet: 'Não definido',
      financials: 'Financeiro',
      cost: 'Custo',
      notQuoted: 'Sem orçamento',
      payment: 'Pagamento',
      backToDashboard: 'Voltar ao Painel',
      serviceRequestNotFound: 'Pedido de Serviço não encontrado.',
      dashboardSummary: 'Aqui está um resumo de suas atividades.',
      noServiceRequestsFound: 'Nenhum pedido de serviço encontrado.',
      quote: 'Orçamento',
      approve: 'Aprovar',
      reject: 'Rejeitar',
      payNow: 'Pagar Agora',
      chat: 'Chat',
      chatDiscussing: 'Discutindo',
      noProfessionalAssigned: 'Nenhum profissional atribuído ainda.',
      chatPlaceholder: 'Digite sua mensagem...',
      uploadPhoto: 'Enviar foto',
      useCamera: 'Usar câmera',
      mySpecialties: 'Minhas Especialidades',
      saveChanges: 'Salvar Alterações',
      capturePhoto: 'Capturar Foto',
      capture: 'Capturar',
      
      // Search
      searchServiceRequests: 'Buscar Pedidos de Serviço',
      searchTerm: 'Termo de Busca',
      searchTermPlaceholder: 'ex: "torneira vazando"',
      allCategories: 'Todas as Categorias',
      allStatuses: 'Todos os Status',
      results: 'Resultados',
      noResultsFound: 'Nenhum resultado encontrado para seus critérios.',
      
      // Scheduling
      scheduleAppointmentFor: 'Marcar Horário Para',
      selectProfessional: 'Selecione o Profissional',
      selectAProfessional: 'Selecione um profissional',
      selectACategory: 'Selecione uma categoria',
      selectDate: 'Selecione a Data',
      selectTime: 'Selecione a Hora',
      confirmSchedule: 'Confirmar Agendamento',
      
      // Admin
      pendingActions: 'Ações Pendentes',
      noRequestsNeedAttention: 'Nenhum pedido precisa de sua atenção no momento.',
      viewQuote: 'Ver Orçamento',
      provideQuote: 'Fornecer Orçamento',
      assign: 'Atribuir',
      pendingRegistrations: 'Registros Pendentes',
      name: 'Nome',
      phone: 'Telefone',
      noPendingRegistrations: 'Não há registros pendentes.',
      financialDetails: 'Detalhes Financeiros',
      exportToCsv: 'Exportar para CSV',
      date: 'Data',
      total: 'Total',
      action: 'Ação',
      generateInvoice: 'Gerar Fatura',
      manageProfessionals: 'Gerenciar Profissionais',
      addProfessional: 'Adicionar Profissional',
      addNewProfessional: 'Adicionar Novo Profissional',
      specialties: 'Especialidades',
      add: 'Adicionar',
      edit: 'Editar',
      addNewCategory: 'Adicionar Nova Categoria',
      categoryName: 'Nome da Categoria',
      serviceCategories: 'Categorias de Serviço',
      delete: 'Excluir',
      quoteFor: 'Orçamento Para',
      quoteValue: 'Valor do Orçamento',
      submit: 'Enviar',
      assignProfessional: 'Atribuir Profissional',
      selectProfessionalFor: 'Selecione um profissional para',
      editProfessional: 'Editar Profissional',
      invoice: 'Fatura',
      billedTo: 'Cobrado de',
      serviceProvidedBy: 'Serviço Prestado Por',
      serviceDescription: 'Descrição do Serviço',
      subtotal: 'Subtotal',
      tax: 'Imposto',
      grandTotal: 'Total Geral',
      thankYou: 'Obrigado por sua preferência!',
      close: 'Fechar',
      print: 'Imprimir',

      // General
      dashboard: 'Painel',
      schedule: 'Agenda',
      search: 'Busca',
      profile: 'Perfil',
      newRequest: 'Novo Pedido',
      adminPanel: 'Painel Admin',
      welcomeBack: 'Bem-vindo(a) de volta, {name}!',
      invalidCredentials: 'E-mail ou senha inválidos.',
      accountPending: 'Sua conta está pendente de aprovação.',
      accountRejected: 'Sua conta foi rejeitada.',
      registrationSuccess: 'Registro concluído! Por favor, verifique seu e-mail para um código de verificação.',
      accountVerified: 'Conta verificada com sucesso. Você já pode fazer login.',
      verificationCodeResent: 'Um novo código de verificação foi enviado para {email}.',
      detailsFor: 'Detalhes para: {title}',
      chatFor: 'Chat para: {title}',
      paymentProcessStarted: 'Processo de pagamento iniciado para "{title}".',
      requestSubmittedNotification: 'Novo pedido "{title}" enviado com sucesso.',
      clientAccountApproved: 'Conta de cliente aprovada.',
      clientAccountRejected: 'Conta de cliente rejeitada.',
      pushAccountApprovedTitle: 'Conta Aprovada!',
      pushAccountApprovedBody: 'Bem-vindo(a), {name}! Sua conta está ativa.',
      quoteSubmittedNotification: 'Orçamento de {amount} enviado para o pedido #{id}.',
      pushQuoteReceivedTitle: 'Você Recebeu um Orçamento!',
      pushQuoteReceivedBody: 'Um novo orçamento de {amount} foi enviado para "{title}".',
      approvedStatus: 'aprovado',
      rejectedStatus: 'rejeitado',
      quoteResponseNotification: 'O orçamento para o pedido #{id} foi {status}.',
      pushQuoteResponseTitle: 'Resposta ao Orçamento',
      pushQuoteResponseBody: 'O orçamento para "{title}" foi {status}.',
      professionalAssignedNotification: 'Um profissional foi atribuído ao pedido #{id}.',
      pushJobAssignedTitle: 'Novo Trabalho Atribuído!',
      pushJobAssignedBody: 'Você foi atribuído a um novo trabalho: "{title}".',
      appointmentScheduledNotification: 'Agendamento marcado para "{title}".',
      pushAppointmentScheduledTitle: 'Novo Agendamento!',
      pushAppointmentScheduledBody: 'Um agendamento para "{title}" foi marcado para {date}.',
      profileUpdatedNotification: 'Perfil do usuário #{id} atualizado.',
      noChangesDetected: 'Nenhuma alteração para salvar.',
      errorInvalidFileFormat: 'Formato de arquivo inválido. Por favor, envie JPG, PNG, ou GIF.',
      errorImageTooLarge: 'A imagem é muito grande. O tamanho máximo é 2MB.',
      errorCameraNotSupported: 'O acesso à câmera não é suportado pelo seu navegador.',
      errorAccessingCamera: 'Erro ao acessar a câmera. Por favor, garanta que concedeu permissão.',
      categoryAddedNotification: 'Categoria "{category}" adicionada.',
      categoryUpdatedNotification: 'Categoria "{oldName}" atualizada para "{newName}".',
      categoryDeletedNotification: 'Categoria "{category}" deletada.',
      confirmDeleteCategory: 'Tem certeza que deseja deletar a categoria "{category}"? Esta ação não pode ser desfeita.',
      professionalAddedNotification: 'Profissional "{name}" foi adicionado.',
      pushNotificationsBlocked: 'As notificações push estão bloqueadas. Por favor, ative-as nas configurações do seu navegador.',
      pushSubscriptionFailed: 'Falha ao inscrever-se para notificações push.',
      currency: 'BRL',
      chatSimulatedReply: 'Ok, vou verificar e retorno em breve.',
      unknownClient: 'Cliente Desconhecido',
      unassigned: 'Não atribuído',
      confirmRejectRegistration: 'Tem certeza que deseja rejeitar este registro?',
      noDataToExport: 'Não há dados financeiros para exportar.',
      reportExported: 'Relatório financeiro exportado com sucesso.',
      csvId: 'ID',
      csvClient: 'Cliente',
      csvProfessional: 'Profissional',
      csvService: 'Serviço',
      csvCompletionDate: 'Data de Conclusão',
      csvPaymentStatus: 'Status Pagamento',
      csvBaseValue: 'Valor Base',
      csvTax: 'Imposto (7%)',
      csvTotalValue: 'Valor Total',
      paid: 'Pago',
      unpaid: 'Não Pago',
      overview: 'Visão Geral',
      requests: 'Pedidos',
      approvals: 'Aprovações',
      professionals: 'Profissionais',
      categories: 'Categorias',
      finances: 'Finanças',
      totalRevenue: 'Receita Total',
      pendingApprovals: 'Aprovações Pendentes',
      activeServices: 'Serviços Ativos',
      totalProfessionals: 'Total de Profissionais',
      pendingApproval: 'Aprovação Pendente',
      activeRequests: 'Pedidos Ativos',
      completed: 'Concluídos',
      activeJobs: 'Trabalhos Ativos',
      completedJobs: 'Trabalhos Concluídos',
      totalEarnings: 'Ganhos Totais',
      serviceTitle: 'Título do Serviço',
      detailedDescription: 'Descrição Detalhada',
      category: 'Categoria',
      serviceAddress: 'Endereço do Serviço',
      searchForAddress: 'Procure um endereço...',
      preferredDate: 'Data Preferencial',
      optional: 'Opcional',
      reset: 'Limpar',
      submitRequest: 'Enviar Pedido',
    },
  };

  setLanguage(lang: Language) {
    this.language.set(lang);
  }
  
  translate(key: string, params?: Record<string, string | number>): string {
    const lang = this.language();
    let translation = this.translations[lang][key] || this.translations['en'][key] || key;
    
    if (params) {
      Object.keys(params).forEach(paramKey => {
        translation = translation.replace(`{${paramKey}}`, String(params[paramKey]));
      });
    }
    
    return translation;
  }
}
